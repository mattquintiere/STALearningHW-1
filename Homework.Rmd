---
title: 'Homework #1'
author: "Matt Quintiere and Rohit Gunda"
date: "2023-10-16"
output: pdf_document
---
#Setup

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r libraries}
library(tidyverse)
library(tidymodels)
library(knitr)
library(palmerpenguins)
library(GGally)
library(factoextra)
view(penguins)
```


#Data Cleaning
```{r original-dataset}
penguins
```

```{r remove-na}
#Removing NAs in the dataset
penguins2 <- penguins[rowSums(is.na(penguins)) < 2, ]
```

```{r outliers}
ggplot(penguins2,aes(x=species, y=bill_length_mm)) + 
  geom_boxplot() 
ggplot(penguins2,aes(x=species, y=bill_depth_mm)) + 
  geom_boxplot() 
penguins2 <- penguins2 %>% 
  mutate(outlier = ifelse(bill_length_mm > 58, FALSE, TRUE))
penguins2 <- penguins2 %>% 
  filter(outlier == TRUE)
penguins2 <- penguins2 %>% 
  mutate(outlier2 = ifelse(bill_depth_mm > 21.2, FALSE, TRUE))
penguins2 <- penguins2 %>% 
  filter(outlier2 == TRUE)
penguins2 <- penguins2 %>% 
  select(species, island, bill_length_mm, bill_depth_mm, flipper_length_mm, body_mass_g, sex, year)
```
#Visualization
```{r, message = FALSE}
penguins2 %>% 
  ggplot(aes(x = bill_length_mm, y = body_mass_g, color = species)) +
  geom_point() +
  labs(y = "Body Mass (Grams)",
       x = "Bill Length (mm)",
       title = "Relationship between Bill Length and Body Mass",
       subtitle = "Seperated by Color",
       color = "Species") +
  geom_smooth(method = "lm")
```

```{r correlation plot}
ggcorr(penguins2)
```

#PCA
To explore the principal components of our data set to explain the variability, we have to isolate the numeric variables in the dataset, which are `bill_length_mm`, `bill_depth_mm`, `flipper_length_mm`, `body_mass_g`. The reason we can only use numeric variables is because the PCA relies linear algebra calculations which can only be used with numeric data.
```{r}
pca_penguins2 <- penguins2[,3:6]

pca = prcomp(pca_penguins2, scale = TRUE)
names(pca)
summary(pca)
```
Running the PCA calculations out using the prcomp tool, we see that the first two principal components are responsible for about 88% percent of the data. Let's create a screeplot to visualize this: 
```{r}
fviz_eig(pca, addlabels = TRUE,
         ylim = c(0,80))
```
**Kaiser Rule**
```{r}
fviz_eig(pca, 
         addlabels = TRUE, 
         choice="eigenvalue",
         main="Figure 2") +
         geom_hline(yintercept=1, 
         linetype="dashed", 
         color = "red")

```

```{r}
fviz_contrib(pca, choice = "var", axes = 1)
```

#Factor Analysis
```{r}

```
#Cluster Analysis


